<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>تقديم صانع محتوى</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  /* ===== Theme Variables ===== */
  :root{
    --bg:#f7f8fc; --card:#ffffff; --muted:#5b6477; --text:#1b2333;
    --accent:#C99A00; --ok:#178f5a; --danger:#c73737;
    --input:#f2f4fb; --ring:#d7dced;
    --navy:#0a0f2b; --violet:#6123d6; --pink:#ff4fa1; --cyan:#32e1ff; --teal:#12c2e9; --silver:#dbe3ff;
  }
  html[data-theme="dark"]{
    --bg:#0f1220; --card:#14182a; --muted:#aeb6cf; --text:#eef1ff;
    --input:#161c30; --ring:#2a3350;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg);
    font-family:'Cairo',system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color:var(--text); line-height:1.7;
    display:flex; justify-content:center; padding:20px;
    transition: background .2s ease, color .2s ease;
  }
  .wrap{width:100%; max-width:980px}

  /* Top bar */
  .topbar{
    display:flex; justify-content:flex-end; gap:8px; margin-bottom:10px;
  }
  .tbtn{
    background:var(--card); color:var(--text);
    border:1px solid var(--ring); border-radius:10px;
    padding:8px 12px; cursor:pointer; font-weight:700;
  }

  /* ===== Banner wrapper ===== */
  .banner-frame{
    width:100%; background:var(--card); border:2px solid var(--ring); border-radius:16px;
    padding:8px; margin-bottom:18px; box-shadow:0 6px 22px rgba(0,0,0,.08);
  }

  /* ===== Banner (from your design) ===== */
  .banner{
    position:relative; width:100%; height:225px; max-width:100%;
    overflow:hidden; border:4px solid var(--silver); border-radius:14px;
    box-shadow:0 0 18px rgba(219,227,255,.35), inset 0 0 10px rgba(255,255,255,.12);
    background:
      radial-gradient(1100px 225px at 20% 50%, rgba(50,225,255,.2), transparent 60%),
      linear-gradient(90deg, #0b1536 0%, var(--violet) 55%, var(--pink) 100%);
    isolation:isolate;
  }
  .shine{
    position:absolute; inset:0;
    background:linear-gradient(75deg, transparent 20%, rgba(255,255,255,.13) 45%, transparent 70%);
    transform:skewX(-8deg) translateX(-120%);
    animation:shineMove 6s linear infinite; pointer-events:none;
  }
  @keyframes shineMove{ to{ transform:skewX(-8deg) translateX(120%);} }

  .content{
    position:absolute; inset:0; display:grid;
    grid-template-columns:170px 1fr 260px; align-items:center; gap:10px; padding:14px 18px;
  }
  .cta{ display:flex; align-items:center; justify-content:center; padding-inline:6px; }
  .cta a{
    display:inline-block; background:linear-gradient(180deg, var(--cyan), var(--teal));
    color:#0f0f15; font-weight:800; font-size:18px; text-decoration:none;
    padding:10px 16px; border-radius:12px;
    box-shadow:0 6px 14px rgba(0,0,0,.45), 0 0 12px rgba(50,225,255,.45) inset;
    border:1px solid rgba(0,0,0,.25); text-shadow:0 1px 0 rgba(255,255,255,.5);
    position:relative; overflow:hidden;
  }
  .cta a::after{
    content:""; position:absolute; inset:0;
    background:linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
    transform:translateX(-120%); animation:ctaShine 3.6s ease-in-out infinite;
  }
  @keyframes ctaShine{ 50%{ transform:translateX(120%);} }

  .text{ color:#fff; text-align:center; padding:0 8px; }
  .title{ margin:0 0 6px; font-size:28px; line-height:1.2; font-weight:800; color:#fff;
    text-shadow:0 2px 8px rgba(0,0,0,.55), 0 0 10px rgba(49,225,255,.35); white-space:nowrap; }
  .subtitle{ margin:0; font-size:16.5px; line-height:1.25; color:#f1f5ff; text-shadow:0 2px 5px rgba(0,0,0,.6); }
  .mascot{ display:flex; align-items:center; justify-content:center; filter:drop-shadow(0 6px 10px rgba(0,0,0,.45)); }
  .mascot svg{ height:180px; width:auto; }

  .floaters{ position:absolute; inset:0; pointer-events:none; }
  .floater{ position:absolute; opacity:.95; filter:drop-shadow(0 4px 6px rgba(0,0,0,.4)); }
  @keyframes floatUp { 0% { transform:translateY(0) scale(1) rotate(0deg); opacity:0; }
                        10%{ opacity:1; } 80%{ opacity:1; }
                        100%{ transform:translateY(-110px) scale(1.05) rotate(360deg); opacity:0; } }
  .icon{ animation: floatUp 6s linear infinite; }
  .i1{ left:80px;  bottom:16px; animation-delay:.2s }
  .i2{ left:210px; bottom:14px; animation-delay:1.1s }
  .i3{ left:520px; bottom:12px; animation-delay:1.9s }
  .i4{ left:700px; bottom:18px; animation-delay:2.7s }
  .i5{ left:820px; bottom:14px; animation-delay:3.3s }
  .icon svg{ width:28px; height:28px; }
  .play svg{ width:30px; height:30px; }

  @media (max-width:920px){
    .title{ font-size:26px } .subtitle{ font-size:15.5px } .banner{ height:200px }
  }
  @media (max-width:680px){
    .banner{ height:180px }
    .content{ grid-template-columns:1fr; grid-template-rows:auto auto; gap:8px; padding:12px; justify-items:center; text-align:center; }
    .cta a{ width:100%; text-align:center; font-size:16px; padding:10px 14px }
    .title{ font-size:22px; white-space:normal } .subtitle{ font-size:14px }
    .mascot{ display:none } .i4, .i5{ display:none }
  }
  @media (prefers-reduced-motion: reduce){
    .icon, .shine, .cta a::after{ animation:none !important }
  }

  /* ===== Card / Form ===== */
  .card{
    background:var(--card); border:1px solid var(--ring); border-radius:16px; padding:20px;
    box-shadow:0 8px 28px rgba(16,24,40,.06);
  }
  h2{
    margin:6px 0 12px; font-size:26px;
    background:linear-gradient(90deg,var(--accent), #FFD54A 35%, #B8860B);
    -webkit-background-clip:text; background-clip:text; color:transparent; text-align:center;
  }
  .desc{color:var(--muted); margin-bottom:16px; text-align:center}
  .actions{display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; margin-bottom:12px}
  .btn{
    border:none; cursor:pointer; border-radius:12px; padding:10px 16px; font-weight:700;
    background:linear-gradient(135deg,#FFD54A,#E6B800); color:#2a2200; box-shadow:0 6px 18px rgba(255,213,74,.25);
  }
  .ghost{background:#eef1ff; color:#2a2f55; border:1px solid var(--ring)}

  form{display:grid; gap:14px; scroll-margin-top:90px}
  .grid{display:grid; gap:12px}
  @media(min-width:720px){ .grid.cols-2{grid-template-columns:1fr 1fr} }
  label{display:block; font-weight:700; margin-bottom:6px}
  .field{
    background:var(--input); border:1px solid var(--ring); border-radius:12px; padding:12px 14px;
    color:var(--text); width:100%; font-size:16px;
  }
  select.field{padding-right:12px}
  .row{display:flex; gap:10px; align-items:center}
  .prefix{ background:var(--card); border:1px solid var(--ring); color:var(--text);
    padding:12px 14px; border-radius:12px; min-width:88px; text-align:center; font-size:15px; }
  .hint{color:var(--muted); font-size:12px; margin-top:6px}
  .chips{display:flex; flex-wrap:wrap; gap:8px}
  .chip{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background:#f4f6ff22; border:1px solid var(--ring); cursor:pointer; user-select:none}
  .chip input{accent-color:#E6B800; transform:scale(1.1)}
  .divider{height:1px; background:var(--ring); margin:4px 0 8px}
  .hidden{display:none !important}
  .footer{display:flex; gap:12px; margin-top:8px; flex-wrap:wrap; align-items:center}
  .footer .btn{min-width:160px}
  .msg{padding:10px 12px; border-radius:10px; font-weight:700}
  .ok{background:#e9f8f1; color:#055a38; border:1px solid #bdebd3}
  .err{background:#fdecec; color:#7a1d1d; border:1px solid #f3bcbc}

  /* invalid helper */
  .invalid{ color:var(--danger); font-size:12px; margin-top:6px }
</style>
</head>
<body>
  <div class="wrap">

    <!-- Language / Theme -->
    <div class="topbar">
      <button id="langBtn" class="tbtn">English</button>
      <button id="themeBtn" class="tbtn">🌙</button>
    </div>

    <!-- Banner -->
    <div class="banner-frame">
      <div class="banner" role="img" aria-label="تقديم صانع محتوى">
        <div class="shine"></div>
        <div class="content">
          <div class="cta"><a href="#creatorForm" data-i="cta">قدّم الآن</a></div>
          <div class="text">
            <h1 class="title" data-i="heroTitle">✨ تقديم صانع محتوى</h1>
            <p class="subtitle" data-i="heroSub">اعرض موهبتك، وقدّم سيرتك وأعمالك للانضمام إلينا.</p>
          </div>
          <div class="mascot" aria-hidden="true">
            <!-- SVG -->
            <svg viewBox="0 0 230 220" xmlns="http://www.w3.org/2000/svg">
              <ellipse cx="120" cy="205" rx="65" ry="10" fill="rgba(0,0,0,.25)"/>
              <path d="M60 170 Q60 130 90 120 L150 120 Q180 130 180 170 L180 185 Q180 195 170 198 L70 198 Q60 195 60 185 Z" fill="#1cc8e5" stroke="#0eaec8" stroke-width="2"/>
              <path d="M150 130 Q165 138 175 160" fill="none" stroke="#0eaec8" stroke-width="10" stroke-linecap="round"/>
              <g transform="translate(172,156)">
                <rect x="-4" y="-4" width="18" height="34" rx="6" fill="#1e1e2b"/>
                <rect x="-1" y="-1" width="12" height="14" rx="4" fill="#444a65"/>
                <rect x="-1" y="14" width="12" height="6" rx="2" fill="#2e334a"/>
              </g>
              <circle cx="120" cy="90" r="34" fill="#ffdfc9" stroke="#e0b9a4" stroke-width="2"/>
              <path d="M86 90 Q90 58 120 56 Q150 58 154 90 Q150 78 140 72 Q130 66 120 66 Q110 66 100 72 Q90 78 86 90Z" fill="#2b2b40"/>
              <rect x="80" y="84" width="12" height="20" rx="6" fill="#2b2b40"/>
              <rect x="148" y="84" width="12" height="20" rx="6" fill="#2b2b40"/>
              <path d="M92 78 Q120 70 148 78" fill="none" stroke="#2b2b40" stroke-width="8" stroke-linecap="round"/>
              <circle cx="108" cy="92" r="3.2" fill="#1a1a1a"/>
              <circle cx="132" cy="92" r="3.2" fill="#1a1a1a"/>
              <path d="M108 104 Q120 112 132 104" fill="none" stroke="#c25b7a" stroke-width="3" stroke-linecap="round"/>
              <g transform="translate(60,120)">
                <rect x="0" y="0" width="40" height="22" rx="5" fill="#2d2f48"/>
                <rect x="28" y="-6" width="10" height="10" rx="2" fill="#2d2f48"/>
                <circle cx="12" cy="11" r="6" fill="#101222" stroke="#58e8ff" stroke-width="2"/>
                <circle cx="12" cy="11" r="2" fill="#58e8ff"/>
              </g>
              <g transform="translate(95,145)">
                <rect x="0" y="0" width="16" height="26" rx="3" fill="#141826" stroke="#3ad7ff" stroke-width="1.5"/>
                <circle cx="8" cy="6" r="3" fill="#ff3d81"/>
                <rect x="4" y="12" width="8" height="10" rx="2" fill="#20263a"/>
              </g>
            </svg>
          </div>
        </div>
        <div class="floaters" aria-hidden="true">
          <div class="floater icon play i1">
            <svg viewBox="0 0 64 64">
              <circle cx="32" cy="32" r="20" fill="rgba(50,225,255,.15)" stroke="#32e1ff" stroke-width="3"/>
              <polygon points="26,22 44,32 26,42" fill="#32e1ff"/>
            </svg>
          </div>
          <div class="floater icon i2">
            <svg viewBox="0 0 64 64">
              <rect x="26" y="16" width="12" height="22" rx="6" fill="#ff4fa1"/>
              <rect x="22" y="36" width="20" height="4" rx="2" fill="#ffd2e7"/>
              <rect x="30" y="40" width="4" height="8" rx="2" fill="#ffd2e7"/>
            </svg>
          </div>
          <div class="floater icon i3">
            <svg viewBox="0 0 64 64">
              <rect x="10" y="22" width="36" height="22" rx="6" fill="#2d2f48"/>
              <rect x="46" y="26" width="8" height="10" rx="2" fill="#2d2f48"/>
              <circle cx="28" cy="33" r="7" fill="#101222" stroke="#58e8ff" stroke-width="3"/>
            </svg>
          </div>
          <div class="floater icon play i4">
            <svg viewBox="0 0 64 64">
              <circle cx="32" cy="32" r="20" fill="rgba(255,79,161,.12)" stroke="#ff4fa1" stroke-width="3"/>
              <polygon points="26,22 44,32 26,42" fill="#ff4fa1"/>
            </svg>
          </div>
          <div class="floater icon i5">
            <svg viewBox="0 0 64 64">
              <rect x="26" y="16" width="12" height="22" rx="6" fill="#32e1ff"/>
              <rect x="22" y="36" width="20" height="4" rx="2" fill="#bfefff"/>
              <rect x="30" y="40" width="4" height="8" rx="2" fill="#bfefff"/>
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- Form -->
    <div class="card">
      <h2 data-i="formTitle">نموذج تقديم صانع محتوى</h2>
      <p class="desc" data-i="formDesc">املأ البيانات، وسيتم إرسالها مباشرة إلى Google Sheets.</p>

      <div class="actions">
        <button type="button" id="guideBtn" class="btn" data-i="guideBtn">📘 دليل صانع المحتوى</button>
        <button type="button" id="testSubmit" class="btn ghost" data-i="testBtn">🧪 اختبار الإرسال</button>
      </div>

      <form id="creatorForm" novalidate>
        <div class="grid cols-2">
          <div>
            <label for="name" data-i="nameLbl">الاسم الكامل *</label>
            <input class="field" id="name" type="text" required />
          </div>
          <div>
            <label for="gender" data-i="genderLbl">الجنس *</label>
            <select class="field" id="gender" required>
              <option value="" selected disabled data-i="optChoose">اختر</option>
              <option data-i="optMale">ذكر</option>
              <option data-i="optFemale">أنثى</option>
              <option data-i="optOther">آخر</option>
            </select>
          </div>
        </div>

        <div class="grid cols-2">
          <div>
            <label for="country" data-i="countryLbl">الدولة *</label>
            <select class="field" id="country" required>
              <option value="" selected disabled data-i="optCountry">اختر دولتك</option>
              <option value="EG">مصر</option>
              <option value="SA">السعودية</option>
              <option value="AE">الإمارات</option>
              <option value="KW">الكويت</option>
              <option value="QA">قطر</option>
              <option value="BH">البحرين</option>
              <option value="OM">عُمان</option>
              <option value="YE">اليمن</option>
              <option value="JO">الأردن</option>
              <option value="LB">لبنان</option>
              <option value="SY">سوريا</option>
              <option value="IQ">العراق</option>
              <option value="PS">فلسطين</option>
              <option value="IL">إسرائيل</option>
              <option value="TR">تركيا</option>
              <option value="IR">إيران</option>
              <option value="SD">السودان</option>
              <option value="LY">ليبيا</option>
            </select>
            <div class="hint" data-i="countryHint">مقدّمة الواتساب تتغيّر تلقائيًا حسب الدولة.</div>
          </div>

          <div>
            <label for="likee">Likee ID</label>
            <input class="field" id="likee" type="text" placeholder="إن وجد" />
          </div>
        </div>

        <div>
          <label data-i="waLbl">رقم الواتساب *</label>
          <div class="row">
            <div class="prefix" id="dialPrefix">+20</div>
            <input class="field" id="whats" type="tel" inputmode="numeric" placeholder="اكتب رقمك بدون المقدمة" required />
          </div>
          <div class="hint" id="waHint">مثال: 10XXXXXXXX — اكتب الرقم بدون رمز الدولة.</div>
          <div class="invalid hidden" id="waError">الرقم غير صالح لهذه الدولة.</div>
        </div>

        <div>
          <label data-i="hasTalentLbl">هل لديك موهبة؟ *</label>
          <div class="chips" role="radiogroup">
            <label class="chip"><input type="radio" name="hasTalent" value="نعم" required> <span data-i="yes">نعم</span></label>
            <label class="chip"><input type="radio" name="hasTalent" value="لا" required> <span data-i="no">لا</span></label>
          </div>
        </div>

        <div id="talentBox" class="hidden">
          <label class="section-title" data-i="talentsTitle">ما هي الموهبة التي تقدمها؟</label>
          <div class="chips">
            <label class="chip"><input type="checkbox" name="talents" value="رسم"> <span data-i="talentDraw">رسم</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="عزف"> <span data-i="talentPlay">عزف</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="غناء"> <span data-i="talentSing">غناء</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="تقليد أصوات"> <span data-i="talentImpersonate">تقليد أصوات</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="شعر"> <span data-i="talentPoetry">شعر</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="تمثيل"> <span data-i="talentActing">تمثيل</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="رقص"> <span data-i="talentDance">رقص</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="أعمال يدوية"> <span data-i="talentHand">أعمال يدوية</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="طبخ"> <span data-i="talentCook">طبخ</span></label>
            <label class="chip"><input type="checkbox" name="talents" value="أخرى" id="talentOtherChk"> <span data-i="talentOther">أخرى</span></label>
          </div>
          <div id="talentOtherWrap" class="hidden" style="margin-top:10px">
            <input class="field" id="talentOther" type="text" placeholder="اكتب موهبتك الأخرى" />
          </div>
        </div>

        <div class="divider"></div>

        <div>
          <label data-i="workedLbl">هل عملت على أي منصة أخرى؟ *</label>
          <div class="chips" role="radiogroup">
            <label class="chip"><input type="radio" name="workedBefore" value="نعم" required> <span data-i="yes">نعم</span></label>
            <label class="chip"><input type="radio" name="workedBefore" value="لا" required> <span data-i="no">لا</span></label>
          </div>
        </div>

        <div id="platformNameWrap" class="hidden">
          <label for="platformName" data-i="platformLbl">اسم المنصة التي عملت عليها من قبل</label>
          <input class="field" id="platformName" type="text" placeholder="TikTok, Likee, YouTube..." />
        </div>

        <div>
          <label data-i="gtLbl">هل لديك أكثر من 10K متابع؟ *</label>
          <div class="chips" role="radiogroup">
            <label class="chip"><input type="radio" name="gt10k" value="نعم" required> <span data-i="yes">نعم</span></label>
            <label class="chip"><input type="radio" name="gt10k" value="لا" required> <span data-i="no">لا</span></label>
          </div>
        </div>

        <div>
          <label for="invite" data-i="inviteLbl">كود الدعوة</label>
          <input class="field" id="invite" type="text" placeholder="إن وجد" />
        </div>

        <div class="footer">
          <button type="submit" class="btn" data-i="submitBtn">إرسال الاستبيان</button>
          <button type="reset" class="btn" style="background:#eaeefb" data-i="resetBtn">تفريغ الحقول</button>
          <span id="formMsg" class="msg hidden"></span>
        </div>
      </form>
    </div>
  </div>

<script>
  /* ===== Config ===== */
  const GUIDE_URL  = "https://a7medras.github.io/broadcaster-guide/";
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzb6QmbgguRd5ZEfGmAHkNwEzbXs4TdVW1m-8TLAX4wk19qx4lY7b4BYyI4g2kq4T0yIA/exec";

  /* ===== Country → Dial codes ===== */
  const dialByCountry = {
    EG:"+20", SA:"+966", AE:"+971", KW:"+965", QA:"+974", BH:"+973", OM:"+968",
    YE:"+967", JO:"+962", LB:"+961", SY:"+963", IQ:"+964", PS:"+970", IL:"+972",
    TR:"+90", IR:"+98", SD:"+249", LY:"+218"
  };

  /* ===== Strong WhatsApp validations per country (local number, without country code) =====
     NOTE: هذه قواعد عملية شائعة وليست رسمية 100% لكل دولة. */
  const waRules = {
    EG: {pattern:/^(10|11|12|15)\d{8}$/, example:"10XXXXXXXX"},
    SA: {pattern:/^5\d{8}$/,              example:"5XXXXXXXX"},
    AE: {pattern:/^5[0-9]\d{7}$/,          example:"5XXXXXXXX"},
    KW: {pattern:/^[569]\d{7}$/,           example:"5XXXXXXX"},
    QA: {pattern:/^[3-7]\d{7}$/,           example:"3XXXXXXX"},
    BH: {pattern:/^[3-9]\d{7}$/,           example:"3XXXXXXX"},
    OM: {pattern:/^9\d{7}$/,               example:"9XXXXXXX"},
    JO: {pattern:/^7\d{8}$/,               example:"7XXXXXXXX"},
    LB: {pattern:/^([3-9]\d{7})$/,         example:"7XXXXXXX"},
    SY: {pattern:/^9\d{8}$/,               example:"9XXXXXXXX"},
    IQ: {pattern:/^7\d{9}$/,               example:"7XXXXXXXXX"},
    PS: {pattern:/^5[69]\d{7}$/,           example:"5XXXXXXXX"},
    IL: {pattern:/^5\d{8}$/,               example:"5XXXXXXXX"},
    TR: {pattern:/^5\d{9}$/,               example:"5XXXXXXXXX"},
    IR: {pattern:/^9\d{9}$/,               example:"9XXXXXXXXX"},
    SD: {pattern:/^9\d{8}$/,               example:"9XXXXXXXX"},
    LY: {pattern:/^9\d{8}$/,               example:"9XXXXXXXX"},
    YE: {pattern:/^7\d{8}$/,               example:"7XXXXXXXX"}
  };

  /* ===== i18n ===== */
  const i18n = {
    ar: {
      cta:"قدّم الآن", heroTitle:"✨ تقديم صانع محتوى", heroSub:"اعرض موهبتك، وقدّم سيرتك وأعمالك للانضمام إلينا.",
      formTitle:"نموذج تقديم صانع محتوى", formDesc:"املأ البيانات، وسيتم إرسالها مباشرة إلى Google Sheets.",
      guideBtn:"📘 دليل صانع المحتوى", testBtn:"🧪 اختبار الإرسال",
      nameLbl:"الاسم الكامل *", genderLbl:"الجنس *", optChoose:"اختر", optMale:"ذكر", optFemale:"أنثى", optOther:"آخر",
      countryLbl:"الدولة *", optCountry:"اختر دولتك", countryHint:"مقدّمة الواتساب تتغيّر تلقائيًا حسب الدولة.",
      waLbl:"رقم الواتساب *",
      hasTalentLbl:"هل لديك موهبة؟ *", yes:"نعم", no:"لا",
      talentsTitle:"ما هي الموهبة التي تقدمها؟",
      talentDraw:"رسم", talentPlay:"عزف", talentSing:"غناء", talentImpersonate:"تقليد أصوات",
      talentPoetry:"شعر", talentActing:"تمثيل", talentDance:"رقص", talentHand:"أعمال يدوية", talentCook:"طبخ", talentOther:"أخرى",
      workedLbl:"هل عملت على أي منصة أخرى؟ *", platformLbl:"اسم المنصة التي عملت عليها من قبل",
      gtLbl:"هل لديك أكثر من 10K متابع؟ *",
      inviteLbl:"كود الدعوة", submitBtn:"إرسال الاستبيان", resetBtn:"تفريغ الحقول",
      waInvalid:"الرقم غير صالح لهذه الدولة.", waExample:"مثال: "
    },
    en: {
      cta:"Apply Now", heroTitle:"✨ Content Creator Application", heroSub:"Show your talent and portfolio to join us.",
      formTitle:"Content Creator Form", formDesc:"Fill the form; data goes directly to Google Sheets.",
      guideBtn:"📘 Creator Guide", testBtn:"🧪 Send Test Row",
      nameLbl:"Full Name *", genderLbl:"Gender *", optChoose:"Choose", optMale:"Male", optFemale:"Female", optOther:"Other",
      countryLbl:"Country *", optCountry:"Select your country", countryHint:"WhatsApp prefix updates automatically.",
      waLbl:"WhatsApp Number *",
      hasTalentLbl:"Do you have a talent? *", yes:"Yes", no:"No",
      talentsTitle:"What talent(s) do you offer?",
      talentDraw:"Drawing", talentPlay:"Instrument", talentSing:"Singing", talentImpersonate:"Voice imitation",
      talentPoetry:"Poetry", talentActing:"Acting", talentDance:"Dance", talentHand:"Handcrafts", talentCook:"Cooking", talentOther:"Other",
      workedLbl:"Have you worked on any platform before? *", platformLbl:"Name of the platform you worked on",
      gtLbl:"Do you have more than 10K followers? *",
      inviteLbl:"Invite Code", submitBtn:"Submit", resetBtn:"Reset",
      waInvalid:"Invalid number for this country.", waExample:"Example: "
    }
  };
  let lang = localStorage.getItem("lang") || "ar";

  function applyLang(){
    const t = i18n[lang];
    document.documentElement.lang = lang;
    if (lang === "ar"){ document.documentElement.dir = "rtl"; }
    else { document.documentElement.dir = "ltr"; }
    // Simple mapping by data-i attribute
    document.querySelectorAll("[data-i]").forEach(el=>{
      const key = el.getAttribute("data-i");
      if (t[key]) el.textContent = t[key];
    });
    // Placeholder adjustments
    const whats = document.getElementById("whats");
    if (whats){
      whats.placeholder = (lang==="ar") ? "اكتب رقمك بدون المقدمة" : "Enter your number without country code";
    }
    document.getElementById("langBtn").textContent = (lang==="ar") ? "English" : "العربية";
    document.getElementById("waError").textContent = t.waInvalid;
    // Example hint update later in onCountryChange
    onCountryChange();
  }

  /* ===== Theme toggle ===== */
  function applyTheme(){
    const saved = localStorage.getItem("theme") || "light";
    document.documentElement.setAttribute("data-theme", saved);
    document.getElementById("themeBtn").textContent = (saved==="dark") ? "☀️" : "🌙";
  }

  /* ===== Links ===== */
  document.getElementById('guideBtn').addEventListener('click', () => {
    window.open(GUIDE_URL, "_blank", "noopener");
  });

  /* ===== Country / Dial / WhatsApp validation ===== */
  const countrySel = document.getElementById('country');
  const dialPrefix = document.getElementById('dialPrefix');
  const whats = document.getElementById('whats');
  const waError = document.getElementById('waError');
  const waHint  = document.getElementById('waHint');

  function onCountryChange(){
    const code = dialByCountry[countrySel.value] || "+";
    dialPrefix.textContent = code;
    const rule = waRules[countrySel.value];
    if (rule){
      const t = i18n[lang];
      waHint.textContent = (t.waExample || "Example: ") + rule.example + (lang==="ar" ? " — اكتب الرقم بدون رمز الدولة." : " — number without country code.");
    } else {
      waHint.textContent = (lang==="ar") ? "اكتب الرقم بدون رمز الدولة." : "Enter the number without country code.";
    }
  }
  countrySel.addEventListener('change', onCountryChange);

  function validateWhats(){
    waError.classList.add("hidden");
    const c = countrySel.value;
    const val = (whats.value||"").replace(/\D/g,""); // digits only
    if (!c || !val){ return true; } // basic required handled by HTML
    const rule = waRules[c];
    if (!rule){ return true; } // fallback to generic
    const ok = rule.pattern.test(val);
    if (!ok){
      waError.classList.remove("hidden");
    }
    return ok;
  }
  whats.addEventListener('input', validateWhats);
  whats.addEventListener('blur', validateWhats);

  /* ===== Talent / platform logic ===== */
  const talentBox = document.getElementById('talentBox');
  const talentOtherChk = document.getElementById('talentOtherChk');
  const talentOtherWrap = document.getElementById('talentOtherWrap');
  const talentOther = document.getElementById('talentOther');
  document.querySelectorAll('input[name="hasTalent"]').forEach(r => {
    r.addEventListener('change', () => {
      const show = r.value === (lang==="ar" ? 'نعم' : 'Yes') && r.checked || r.value === 'نعم' && r.checked;
      talentBox.classList.toggle('hidden', !show);
      if (!show) {
        document.querySelectorAll('input[name="talents"]').forEach(c => c.checked = false);
        talentOtherWrap.classList.add('hidden'); if (talentOther) talentOther.value = "";
      }
    });
  });
  document.querySelectorAll('input[name="talents"]').forEach(c => {
    c.addEventListener('change', () => {
      const otherChecked = talentOtherChk && talentOtherChk.checked;
      talentOtherWrap.classList.toggle('hidden', !otherChecked);
      if (!otherChecked && talentOther) talentOther.value = "";
      if (otherChecked && talentOther) talentOther.focus();
    });
  });
  const platformWrap = document.getElementById('platformNameWrap');
  document.querySelectorAll('input[name="workedBefore"]').forEach(r => {
    r.addEventListener('change', () => {
      const yesVals = ['نعم','Yes'];
      const show = yesVals.includes(r.value) && r.checked;
      platformWrap.classList.toggle('hidden', !show);
      if (!show){ const el=document.getElementById('platformName'); if(el) el.value=""; }
    });
  });

  /* ===== Helpers ===== */
  function genTicketId(){
    // مثال: T-8Q3KZ-6QF2 (قصير ومميز)
    const part = () => Math.random().toString(36).slice(2,6).toUpperCase();
    return "T-" + part() + "-" + part();
  }

  async function sendToSheet(payload){
    await fetch(SCRIPT_URL, {
      method: "POST",
      mode: "no-cors",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
  }

  /* ===== Submit to Google Sheets + Redirect ===== */
  const form = document.getElementById('creatorForm');
  const formMsg = document.getElementById('formMsg');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    formMsg.classList.add('hidden');

    // built-in validity + strong whatsapp
    if (!form.checkValidity() || !validateWhats()) {
      formMsg.textContent = (lang==="ar") ? "تحقق من الحقول المطلوبة" : "Please check required fields";
      formMsg.className = "msg err";
      formMsg.classList.remove('hidden');
      return;
    }

    // جهّز بيانات الإرسال
    const ticketId = genTicketId();
    const data = {
      ticketId,
      name: document.getElementById('name').value.trim(),
      gender: document.getElementById('gender').value,
      country: countrySel.options[countrySel.selectedIndex]?.text || "",
      countryValue: countrySel.value || "",
      countryCode: dialPrefix.textContent,
      whatsapp: whats.value.replace(/\D/g,"").trim(),
      likee: document.getElementById('likee').value.trim(),
      hasTalent: (document.querySelector('input[name="hasTalent"]:checked')||{}).value || "",
      talents: Array.from(document.querySelectorAll('input[name="talents"]:checked')).map(i=>i.value),
      talentOther: (document.getElementById('talentOther')||{}).value || "",
      workedBefore: (document.querySelector('input[name="workedBefore"]:checked')||{}).value || "",
      platformName: (document.getElementById('platformName')||{}).value || "",
      gt10k: (document.querySelector('input[name="gt10k"]:checked')||{}).value || "",
      invite: (document.getElementById('invite')||{}).value || "",
      submittedAt: new Date().toISOString()
    };

    const submitBtn = form.querySelector('button[type="submit"]');
    submitBtn.disabled = true;

    try {
      // ابعت للشييت
      await sendToSheet(data);

      // حوّل لصفحة الشكر بالكود
      window.location.href = "thankyou.html?ticket=" + encodeURIComponent(ticketId);

      // ملاحظة: الكود بعدها مش هيتنفذ لأن الصفحة هتتنقل
    } catch (err) {
      console.error(err);
      formMsg.textContent = (lang==="ar") ? "حصل خطأ أثناء الإرسال ❌" : "Submission error ❌";
      formMsg.className = "msg err";
      formMsg.classList.remove('hidden');
    } finally {
      submitBtn.disabled = false;
    }
  });

  /* ===== Test button – sends sample & redirects ===== */
  document.getElementById('testSubmit').addEventListener('click', async ()=>{
    const ticketId = genTicketId();
    const sample = {
      ticketId,
      name: "TEST USER",
      gender: "ذكر",
      country: "مصر",
      countryValue: "EG",
      countryCode: "+20",
      whatsapp: "1000000000",
      likee: "likee_test",
      hasTalent: "نعم",
      talents: ["رسم","غناء"],
      talentOther: "",
      workedBefore: "لا",
      platformName: "",
      gt10k: "لا",
      invite: "TEST",
      submittedAt: new Date().toISOString()
    };
    try{
      await sendToSheet(sample);
      window.location.href = "thankyou.html?ticket=" + encodeURIComponent(ticketId);
    }catch(e){
      const msg = document.getElementById('formMsg');
      msg.textContent = (lang==="ar") ? "تعذر إرسال الاختبار ❌" : "Test failed ❌";
      msg.className = "msg err"; msg.classList.remove('hidden');
    }
  });

  /* ===== Language & Theme toggles ===== */
  document.getElementById("langBtn").addEventListener("click", ()=>{
    lang = (lang==="ar") ? "en" : "ar";
    localStorage.setItem("lang", lang);
    applyLang();
  });

  document.getElementById("themeBtn").addEventListener("click", ()=>{
    const curr = document.documentElement.getAttribute("data-theme") || "light";
    const next = (curr==="light") ? "dark" : "light";
    localStorage.setItem("theme", next);
    applyTheme();
  });

  // Init
  applyTheme();
  applyLang();
</script>
</body>
</html>
